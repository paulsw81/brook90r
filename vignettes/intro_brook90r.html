<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Paul Schmidt-Walter" />

<meta name="date" content="2018-06-18" />

<title>Introduction to brook90r</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to brook90r</h1>
<h4 class="author"><em>Paul Schmidt-Walter</em></h4>
<h4 class="date"><em>2018-06-18</em></h4>



<p>This vignette gives a brief introduction to the usage of the <em>brook90r</em> R-package. The package serves as an interface between R and the executable code of the hydrological model LWF-BROOK90 <span class="citation">(Hammel and Kennel 2001)</span>. The executable file <em>b90.exe</em> is available at the <a href="https://www.lwf.bayern.de/boden-klima/wasserhaushalt/index.php">Bavarian State Institute of Forestry</a>. The functionnality is presented on a working example.</p>
<hr />
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>LWF-BROOK90 <span class="citation">(Hammel and Kennel 2001)</span> is a hydrological model to calculate daily evaporation (transpiration, interception, and soil evaporation) and soil water fluxes, along with soil water contents and pressure heads of a soil profile covered with vegetation. It is an upgraded version of the original BROOK90 hydrological model <span class="citation">(C. A. Federer, Vörösmarty, and Fekete 2003; C. Federer 2002)</span>, featuring additional parameterizations of the soil water retention and conductivity functions (<span class="citation">Genuchten (1980)</span>; <span class="citation">Mualem (1976)</span>), and the option to take interannual variations of aboveground vegetation characteristics into account when calculating evapotranspiration. Originally, LWF-BROOK90 is used together with an MS ACCESS GUI to organize model input, select model options and parameters and run the model. The basic funcitonality of the GUI is covered by <em>brook90r</em>, and with one function call it will:</p>
<ul>
<li>write input files from climate driving data, model control options and parameters,</li>
<li>start the commandline-tool LWF-BROOK90,</li>
<li>read and return the created output files.</li>
</ul>
<p>The model control options thereby let you select different functions for defining aboveground stand dynamics, phenology, and root length density depth distributions. Additionally, a set of pedotransfer functions is provided to derive hydraulic parameters from soil physical properties.</p>
</div>
<div id="installation" class="section level1">
<h1>Installation</h1>
<p>Before installing the <em>brook90r</em> R-package, be sure to download and install the following packages, as <em>brook90r</em> depends on them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;vegperiod&quot;</span>, <span class="dt">repos=</span><span class="st">&quot;https://www.nw-fva.de/r-pkgs&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;data.table&quot;</span>, <span class="dt">repos=</span><span class="st">&quot;https://cran.rstudio.com/&quot;</span>)</code></pre></div>
<p>As <em>brook90r</em> is not available on CRAN, you have to install it directly from Github, using the <em>devtools</em>-package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;pschmidtwalter/brook90r&quot;</span>)</code></pre></div>
<p>Now load the <em>brook90r</em> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brook90r)</code></pre></div>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>In this vignette, we will use meteorological and soil data from the longterm monitoring beech forest site SLB1 in the Solling mountains, Germany. The datasets are directly available after loading the package. Use <code>?soil_slb1</code> and <code>?meteo_slb1</code> to see the meaning of the variables and their units.</p>
</div>
<div id="basics" class="section level1">
<h1>Basics</h1>
<p>The central function to run LWF-BROOK90 from within R is <code>Run.B90</code>. Before we use it, we need to set up the required input objects that are passed as arguments. Aside from meteorological and soil data, we need to define lists containing the model control options and model parameters. The model control list contains basic information about the simulation (e.g. the start and end dates of the simulation, the phenology model, root length density depth distribution function, etc). The parameter list contains about 100 parameters, of which most are required to run the model, but some only take effect if certain model control options are chosen. Two functions are defined in <em>brook90r</em> that can be used to generate default model options and parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">options.b90 &lt;-<span class="st"> </span><span class="kw">MakeIniControl.B90</span>()
param.b90 &lt;-<span class="st"> </span><span class="kw">MakeParam.B90</span>()</code></pre></div>
<p>The created lists can be easily manipulated by reference, or simply by assigning values to the option and parameter names directly in the function calls. To look up the meanings of the various options and parameters see <code>?MakeIniControl.B90</code> and <code>?MakeParam.B90</code>. The meaning and context of most input parameters (and output variables) can also be looked up in the documentation of the original Brook90 model version on <a href="http://www.ecoshift.net/brook/b90doc.html">Tony Federer’s webpages</a>, which is always a recommended source of information for working with any Brook90 version.</p>
<p>We want to run LWF-Brook90 using the sample data from the Solling site and we need to prepare the datasets for LWF-Brook90. The <em>data.frame</em> <code>soil_slb1</code> contains soil physical data of the soil, but not yet the hydraulic parameters that LWF-BROOK90 requires. Fortunately, <em>brook90r</em> comes with a set of pedotransfer functions to derive the Mualem/van Genuchten parameters of the soil water retention and hydraulic conductivity functions. Here we use texture tabulated values of Wessolek, Renger &amp; Kaupenjohann <span class="citation">(2009)</span> and create a <em>data.frame</em> containing the required MvG-parameters along with the soil physical data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soil &lt;-<span class="st"> </span><span class="kw">cbind</span>(soil_slb1, <span class="kw">hydpar_wessolek_mvg</span>(<span class="dt">tex.KA5 =</span> soil_slb1<span class="op">$</span>texture))</code></pre></div>
<p>Before we run the simulation, we need to select the LWF-BROOK90 output variables and their temporal resolution. Sets of output variables are chosen in a <code>[5,10]</code>-matrix, that we later pass on to LWF-BROOK90. To create the matrix, you can use the function <code>choose_output.B90</code>. It will open a <code>[5,10]</code>-matrix in R’s data-editor, where a default set of output is already selected. You can modify the selection by flagging groups of output variables with <code>0</code> and <code>1</code>. Afterwards, simply close the data-editor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">output &lt;-<span class="st"> </span><span class="kw">choose_output.B90</span>()</code></pre></div>
<p>Now we are ready to start the simulation using the central function <code>Run.B90</code> and save the returned simulation results in an object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b90.results.slb1 &lt;-<span class="st"> </span><span class="kw">Run.B90</span>(<span class="dt">directory =</span> <span class="st">&quot;/example_run_b90/&quot;</span>,
                            <span class="dt">param =</span> param.b90,
                            <span class="dt">inicontrol =</span> options.b90,
                            <span class="dt">soil =</span> soil,
                            <span class="dt">climate =</span> meteo_slb1,
                            <span class="dt">outputmat =</span> output,
                            <span class="dt">output_log =</span> <span class="st">&quot;b90.log&quot;</span>,
                            <span class="dt">path_b90.exe =</span> <span class="st">&quot;H:/R-Packages/brook90r/b90.exe&quot;</span>)</code></pre></div>
<pre><code>## [1] &quot;Creating constant stand properties from parameters...&quot;
## [1] &quot;Standproperties created succesfully&quot;
## [1] &quot;'Climate.in' created succesfully using global radiation&quot;
## [1] &quot;'Param.in' created succesfully!&quot;
## [1] &quot;Running model...&quot;
## [1] &quot;Simulation successful! Duration: 3.75 seconds&quot;
## [1] &quot;Reading output...&quot;
## [1] &quot;Finished!&quot;</code></pre>
<p><code>Run.B90</code> thereby creates the <code>directory</code> folder, derives the daily stand properties (densef, height, lai, sai, age) and writes climate, vegetation properties and parameters to the ‘climate.in’ and ‘param.in’ files into a folder named ‘in’ within <code>directory</code>. It then starts the commandline tool under <code>path_b90.exe</code> which reads the files in the ‘in’ folder and stores its output as .asc-files in the specified folder <code>out.dir</code> (defaults to ‘out/’). As a last step, <code>Run.B90</code> returns the contents of the output files. While running, several messages progress messages are printed to the R-console (if <code>verbose = TRUE</code>). The commandline-feed of ‘b90.exe’ itself is by default redirected to the R-console, but can also be discarded (<code>output_log = FALSE</code>) or written to a file by passing a filename to the <code>output_log</code>-argument of <code>Run.B90</code>, as we did in the example above. The returned object <code>b90.results.slb1</code> is a list of the items containing the desired model output (as specified by the <code>outputmat</code>-argument and named according to the .asc files in the ‘out’-folder), along with the options, parameters and derived daily vegetation properties used in the simulation. Let us have a look at the <code>evapday.asc</code>-item of <code>b90.results.slb1</code> containing daily evaporation fluxes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(b90.results.slb1<span class="op">$</span>evapday.asc)</code></pre></div>
<pre><code>## Classes 'data.table' and 'data.frame':   1095 obs. of  15 variables:
##  $ yr   : int  2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 ...
##  $ mo   : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ da   : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ doy  : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ mesfl: num  0 0 0 0 0 0 0 0 0 0 ...
##  $ flow : num  0.139 0.206 0.287 0.39 0.525 ...
##  $ evap : num  0.234 -0.462 0.291 0.876 0.676 0.226 0.189 0.028 0.199 0.059 ...
##  $ tran : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ irvp : num  0.093 0.074 0.017 0.373 0.394 0.031 0 0.025 0.119 0.038 ...
##  $ isvp : num  0.142 0 0 0 0 0 0 0.003 0 0.021 ...
##  $ slvp : num  0 0.201 0.274 0.503 0.282 0.195 0.189 0 0.08 0 ...
##  $ snvp : num  0 -0.737 0 0 0 0 0 0 0 0 ...
##  $ pint : num  2.53 1.06 1.39 2.36 1.47 ...
##  $ ptran: num  0 0 0 0 0 0 0 0 0 0 ...
##  $ pslvp: num  2.7 1.11 1.34 2.22 1.71 ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<p><em>evapday.asc</em> is a <em>data.table</em>-object (as are all the results returned by <code>Run.B90</code>) and contains date variables (<em>yr, mo, da, doy</em>), actual evaporation fluxes (<em>evap, tran, irvp, isvp, slvp, snvp</em>), potential evaporation fluxes (<em>pint, ptran, pslvp</em>) and total runoff (<em>flow</em>). For plotting, it is convenient to derive a Date object from the date variables. We use the <em>data.table</em> syntax to do so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b90.results.slb1<span class="op">$</span>evapday.asc[, dates <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">paste</span>(yr, mo, da, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>))]</code></pre></div>
<p>Another result that is returned by default are daily soil water state variables (<em>swati, theta, wetnes, psimi, psiti</em>), of the individual soil layers. The file in the ‘out’ folder is named <em>swatday.asc</em> and returned as <em>data.table</em>-object, containing the values of the individual layers organized in rows. We want to plot absolut soil water storage (<em>swati</em>) down to a soil depth of 100 cm, so we need to create a <em>Date</em>-object from the date variables and then integrate <code>b90.results.slb1$swatday.asc$swati</code> over the <em>swati</em>-values of the 14 uppermost soil layers. Again, we use the <em>data.table</em> syntax:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b90.results.slb1<span class="op">$</span>swatday.asc[, dates <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">paste</span>(yr, mo, da, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>))]
swat100cm &lt;-<span class="st"> </span>b90.results.slb1<span class="op">$</span>swatday.asc[nl <span class="op">&lt;=</span><span class="st"> </span><span class="dv">14</span>, 
                                          <span class="kw">list</span>(<span class="dt">swat100_mm =</span> <span class="kw">sum</span>(swati)), 
                                          by =<span class="st"> </span>dates ]</code></pre></div>
<p>Now we can plot the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">4.1</span>,<span class="fl">4.1</span>,<span class="fl">1.1</span>,<span class="fl">4.1</span>))
<span class="kw">plot</span>(b90.results.slb1<span class="op">$</span>evapday.asc<span class="op">$</span>dates, 
     b90.results.slb1<span class="op">$</span>evapday.asc<span class="op">$</span>tran, <span class="dt">type =</span><span class="st">'l'</span>,
     <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;tran [mm]&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">par</span>(<span class="dt">new =</span>T)
<span class="kw">plot</span>(swat100cm<span class="op">$</span>dates,
     swat100cm<span class="op">$</span>swat100_mm, 
     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">150</span>, <span class="dv">350</span>), <span class="dt">type =</span><span class="st">'l'</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,
     <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">yaxt =</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlab=</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">axis</span>(<span class="dv">4</span>,<span class="kw">pretty</span>(<span class="kw">c</span>(<span class="dv">150</span>,<span class="dv">350</span>)))
<span class="kw">mtext</span>(<span class="st">&quot;swat_100cm [mm]&quot;</span>, <span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">line =</span><span class="dv">3</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>,<span class="dt">inset =</span> <span class="op">-</span><span class="fl">0.4</span>,
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;tran&quot;</span>, <span class="st">&quot;swat100cm&quot;</span>),
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>),  <span class="dt">lty =</span> <span class="dv">1</span>, 
      <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xpd =</span>T,  <span class="dt">horiz =</span> T,  <span class="dt">text.width =</span> <span class="dv">100</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="vegetation-characteristics" class="section level1">
<h1>Vegetation characteristics</h1>
<div id="intrannual-variation-of-leaf-index" class="section level2">
<h2>Intrannual variation of leaf index</h2>
<p>In the simulation, we used the default parameters representing a deciduous forest stand, with dynamic dates of budburst and beginning of leaffall as controlled by <code>options.b90$budburst = &quot;dynamic&quot;</code> and <code>options.b90$leaffall = &quot;dynamic&quot;</code>. The models for calculating budburst and leaffall are set in the options with <code>options.b90$budburst.method = &quot;Menzel&quot;</code>,<code>options.b90$species_dynbudburst = &quot;Fagus sylvatica&quot;</code> and <code>options$leaffall.method = &quot;vonWilpert&quot;</code>. With these options, the values of parameters <code>parameters$budburstdoy</code> and <code>param.b90$leaffalldoy</code> become obsolete as these are calculated dynamically from air temperature and daylength. The calculated julian days are then used as temporal anchor points to construct the intraannual variation of leaf area index (LAI) from parameters, using the function <code>MakeSeasLAI</code>. <code>Run.B90</code> calls <code>MakeSeasLAI</code> in the following way:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">LAI_b90 &lt;-<span class="st"> </span><span class="kw">MakeSeasLAI</span>(<span class="dt">maxdoy =</span> <span class="dv">365</span>,
            <span class="dt">maxlai =</span> param.b90<span class="op">$</span>maxlai,
            <span class="dt">minlai =</span> param.b90<span class="op">$</span>maxlai <span class="op">*</span><span class="st"> </span>param.b90<span class="op">$</span>winlaifrac,
            <span class="dt">budburst.doy =</span> param.b90<span class="op">$</span>budburstdoy,
            <span class="dt">leaffall.doy =</span> param.b90<span class="op">$</span>leaffalldoy,
            <span class="dt">emerge.dur =</span> param.b90<span class="op">$</span>emergedur,
            <span class="dt">leaffall.dur =</span> param.b90<span class="op">$</span>leaffalldur,
            <span class="dt">method =</span> options.b90<span class="op">$</span>annuallaidyn)</code></pre></div>
<p>Thereby, parameters and model options are passed from the initial arguments to the function. The default method for the shape of the intraannual LAI course is called ‘b90’, which is implemented in the original LWF-BROOK90 GUI. Here we can also use other shape functions for the LAI course, which also need additional parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">LAI_Coupmodel &lt;-<span class="st"> </span><span class="kw">MakeSeasLAI</span>(<span class="dt">maxdoy =</span> <span class="dv">365</span>,
            <span class="dt">maxlai =</span> param.b90<span class="op">$</span>maxlai <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span>,
            <span class="dt">minlai =</span> param.b90<span class="op">$</span>maxlai <span class="op">*</span><span class="st"> </span>param.b90<span class="op">$</span>winlaifrac <span class="op">+</span><span class="fl">0.05</span>,
            <span class="dt">budburst.doy =</span> param.b90<span class="op">$</span>budburstdoy,
            <span class="dt">leaffall.doy =</span> param.b90<span class="op">$</span>leaffalldoy,
            <span class="dt">opt.doy =</span> param.b90<span class="op">$</span>optdoy,
            <span class="dt">shape.budburst =</span> param.b90<span class="op">$</span>shapestart,
            <span class="dt">shape.leaffall =</span> param.b90<span class="op">$</span>shapeend,
            <span class="dt">method =</span> <span class="st">&quot;Coupmodel&quot;</span>)

LAI_linear &lt;-<span class="st"> </span><span class="kw">MakeSeasLAI</span>(<span class="dt">maxdoy =</span> <span class="dv">365</span>,
            <span class="dt">maxlai =</span> param.b90<span class="op">$</span>maxlai,
            <span class="dt">minlai =</span> param.b90<span class="op">$</span>maxlai <span class="op">*</span><span class="st"> </span>param.b90<span class="op">$</span>winlaifrac,
            <span class="dt">budburst.doy =</span> param.b90<span class="op">$</span>budburstdoy,
            <span class="dt">leaffall.doy =</span> param.b90<span class="op">$</span>leaffalldoy,
            <span class="dt">doy.values =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">121</span>,<span class="dv">130</span>,<span class="dv">150</span>,<span class="dv">180</span>,<span class="dv">210</span>,<span class="dv">280</span>,<span class="dv">310</span>,<span class="dv">330</span>,<span class="dv">365</span>),
            <span class="dt">lai.values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">3</span>,<span class="fl">4.5</span>,<span class="fl">4.9</span>,<span class="fl">4.9</span>,<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>),
            <span class="dt">method =</span> <span class="st">&quot;linear&quot;</span>)

<span class="kw">plot</span>(LAI_b90, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;doy&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;leaf area index&quot;</span>)
<span class="kw">lines</span>(LAI_Coupmodel, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)
<span class="kw">lines</span>(LAI_linear, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;b90&quot;</span>, <span class="st">&quot;Coupmodel&quot;</span>, <span class="st">&quot;linear&quot;</span>),<span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>according to the model specified under <code>options.b90$annuallaidyn</code>. The default setting here is called ‘b90’ referring to the standard method of LWF-BROOK90. Other options are ‘Coupmodel’ or ‘linear’.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-federer_sensitivity_2003">
<p>Federer, C. A., C. Vörösmarty, and B. Fekete. 2003. “Sensitivity of Annual Evaporation to Soil and Root Properties in Two Models of Contrasting Complexity.” <em>J. Hydrometeor</em> 4 (6): 1276–90. doi:<a href="https://doi.org/10.1175/1525-7541(2003)004&lt;1276:SOAETS&gt;2.0.CO;2">10.1175/1525-7541(2003)004&lt;1276:SOAETS&gt;2.0.CO;2</a>.</p>
</div>
<div id="ref-federer_brook_2002">
<p>Federer, C.A. 2002. “BROOK 90: A Simulation Model for Evaporation, Soil Water, and Streamflow.” <a href="http://www.ecoshift.net/brook/brook90.htm" class="uri">http://www.ecoshift.net/brook/brook90.htm</a>.</p>
</div>
<div id="ref-van_genuchten_closed-form_1980">
<p>Genuchten, T. van. 1980. “A Closed-Form Equation for Predicting the Hydraulic Conductivity of Unsaturated Soils.” <em>Soil Science Society of America Journal</em> 44 (5): 892–98. doi:<a href="https://doi.org/10.2136/sssaj1980.03615995004400050002x">10.2136/sssaj1980.03615995004400050002x</a>.</p>
</div>
<div id="ref-hammel_charakterisierung_2001">
<p>Hammel, Klaus, and Martin Kennel. 2001. <em>Charakterisierung Und Analyse Der Wasserverfügbarkeit Und Des Wasserhaushalts von Waldstandorten in Bayern Mit Dem Simulationsmodell BROOK90</em>. Vol. 185. Forstliche Forschungsberichte München.</p>
</div>
<div id="ref-mualem_new_1976">
<p>Mualem, Y. 1976. “A New Model for Predicting the Hydraulic Conductivity of Unsaturated Porous Media.” <em>Water Resource Research</em> 12: 513–22.</p>
</div>
<div id="ref-wessolek_bodenphysikalische_2009">
<p>Wessolek, Gerd, Martin Kaupenjohann, and Manfred Renger. 2009. <em>Bodenphysikalische Kennwerte Und Berechnungsverfahren Für Die Praxis</em>. Bodenökologie Und Bodengenese 40. Berlin: Inst. für Ökologie, Fachgebiet Bodenkunde, Standortkunde und Bodenschutz.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
